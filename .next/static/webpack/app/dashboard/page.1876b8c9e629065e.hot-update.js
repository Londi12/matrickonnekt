"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/dashboard/page",{

/***/ "(app-pages-browser)/./app/utils/userProgress.ts":
/*!***********************************!*\
  !*** ./app/utils/userProgress.ts ***!
  \***********************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addAchievement: () => (/* binding */ addAchievement),\n/* harmony export */   addActivity: () => (/* binding */ addActivity),\n/* harmony export */   getUserProgress: () => (/* binding */ getUserProgress),\n/* harmony export */   initializeUserProgress: () => (/* binding */ initializeUserProgress),\n/* harmony export */   markLessonCompleted: () => (/* binding */ markLessonCompleted),\n/* harmony export */   markTopicCompleted: () => (/* binding */ markTopicCompleted),\n/* harmony export */   recordQuizCompletion: () => (/* binding */ recordQuizCompletion),\n/* harmony export */   updateStreak: () => (/* binding */ updateStreak),\n/* harmony export */   updateStudyTime: () => (/* binding */ updateStudyTime)\n/* harmony export */ });\n/* harmony import */ var _firebase_config__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../firebase/config */ \"(app-pages-browser)/./app/firebase/config.ts\");\n/* harmony import */ var firebase_firestore__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! firebase/firestore */ \"(app-pages-browser)/./node_modules/firebase/firestore/dist/esm/index.esm.js\");\n\n\n// Initialize user progress when they first sign up\nasync function initializeUserProgress(userId) {\n    const userProgressRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.doc)(_firebase_config__WEBPACK_IMPORTED_MODULE_0__.db, 'userProgress', userId);\n    const initialProgress = {\n        userId,\n        subjects: {},\n        totalStudyTime: 0,\n        currentStreak: 0,\n        longestStreak: 0,\n        lastStudyDate: new Date(),\n        recentActivity: [] // Initialize as empty array\n    };\n    await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.setDoc)(userProgressRef, initialProgress);\n    return initialProgress;\n}\n// Get user progress\nasync function getUserProgress(userId) {\n    const userProgressRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.doc)(_firebase_config__WEBPACK_IMPORTED_MODULE_0__.db, 'userProgress', userId);\n    const docSnap = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.getDoc)(userProgressRef);\n    if (docSnap.exists()) {\n        const data = docSnap.data();\n        // Convert timestamp strings back to Date objects\n        if (data.recentActivity && Array.isArray(data.recentActivity)) {\n            data.recentActivity = data.recentActivity.map((activity)=>{\n                if (!activity || typeof activity !== 'object') {\n                    return {\n                        id: Date.now().toString(),\n                        type: 'study',\n                        subject: 'unknown',\n                        topic: 'unknown',\n                        timestamp: new Date()\n                    };\n                }\n                try {\n                    const timestamp = activity.timestamp ? new Date(activity.timestamp) : new Date();\n                    if (isNaN(timestamp.getTime())) {\n                        console.warn('Invalid timestamp in activity:', activity);\n                        return {\n                            ...activity,\n                            timestamp: new Date()\n                        };\n                    }\n                    return {\n                        ...activity,\n                        timestamp\n                    };\n                } catch (error) {\n                    console.warn('Error converting timestamp:', error);\n                    return {\n                        ...activity,\n                        timestamp: new Date()\n                    };\n                }\n            });\n        } else {\n            // Initialize recentActivity if it doesn't exist\n            data.recentActivity = [];\n        }\n        return data;\n    }\n    return null;\n}\n// Mark lesson as completed\nasync function markLessonCompleted(userId, subjectId, topicId, lessonId) {\n    const userProgressRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.doc)(_firebase_config__WEBPACK_IMPORTED_MODULE_0__.db, 'userProgress', userId);\n    const progress = await getUserProgress(userId);\n    if (progress) {\n        // Initialize subjects if it doesn't exist\n        const subjects = progress.subjects || {};\n        const subject = subjects[subjectId] || {\n            progress: 0,\n            completedTopics: [],\n            completedLessons: {},\n            lastStudied: new Date()\n        };\n        // Update completed lessons\n        const topicLessons = subject.completedLessons[topicId] || [];\n        if (!topicLessons.includes(lessonId)) {\n            topicLessons.push(lessonId);\n        }\n        // Calculate topic progress\n        const topicProgress = calculateTopicProgress(topicLessons);\n        // Update subject progress\n        const updatedSubjects = {\n            ...subjects,\n            [subjectId]: {\n                ...subject,\n                completedLessons: {\n                    ...subject.completedLessons,\n                    [topicId]: topicLessons\n                },\n                progress: calculateSubjectProgress(subject, topicId, topicProgress),\n                lastStudied: new Date()\n            }\n        };\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.updateDoc)(userProgressRef, {\n            subjects: updatedSubjects\n        });\n        // Add activity\n        const activity = {\n            id: Date.now().toString(),\n            type: 'study',\n            subject: subjectId,\n            topic: topicId,\n            lessonId,\n            timestamp: new Date()\n        };\n        await addActivity(userId, activity);\n    }\n}\n// Calculate topic progress based on completed lessons\nfunction calculateTopicProgress(completedLessons) {\n    // Assuming each topic has a fixed number of lessons (e.g., 5)\n    const totalLessons = 5; // This should be dynamic based on actual lesson count\n    return completedLessons.length / totalLessons * 100;\n}\n// Calculate subject progress based on topic progress\nfunction calculateSubjectProgress(subject, updatedTopicId, updatedTopicProgress) {\n    const topics = Object.keys(subject.completedLessons);\n    const totalTopics = topics.length;\n    if (totalTopics === 0) return 0;\n    let totalProgress = 0;\n    topics.forEach((topicId)=>{\n        const topicLessons = subject.completedLessons[topicId] || [];\n        const topicProgress = calculateTopicProgress(topicLessons);\n        totalProgress += topicProgress;\n    });\n    return totalProgress / totalTopics;\n}\n// Update study time\nasync function updateStudyTime(userId, minutesStudied) {\n    const userProgressRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.doc)(_firebase_config__WEBPACK_IMPORTED_MODULE_0__.db, 'userProgress', userId);\n    const progress = await getUserProgress(userId);\n    if (progress) {\n        const totalStudyTime = progress.totalStudyTime + minutesStudied;\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.updateDoc)(userProgressRef, {\n            totalStudyTime\n        });\n    }\n}\n// Mark topic as completed\nasync function markTopicCompleted(userId, subjectId, topicId) {\n    const userProgressRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.doc)(_firebase_config__WEBPACK_IMPORTED_MODULE_0__.db, 'userProgress', userId);\n    const progress = await getUserProgress(userId);\n    if (progress) {\n        const subject = progress.subjects[subjectId] || {\n            progress: 0,\n            completedTopics: [],\n            lastStudied: new Date()\n        };\n        if (!subject.completedTopics.includes(topicId)) {\n            const updatedSubjects = {\n                ...progress.subjects,\n                [subjectId]: {\n                    ...subject,\n                    completedTopics: [\n                        ...subject.completedTopics,\n                        topicId\n                    ],\n                    lastStudied: new Date()\n                }\n            };\n            await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.updateDoc)(userProgressRef, {\n                subjects: updatedSubjects\n            });\n            // Add activity\n            const activity = {\n                id: Date.now().toString(),\n                type: 'study',\n                subject: subjectId,\n                topic: topicId,\n                timestamp: new Date()\n            };\n            await addActivity(userId, activity);\n        }\n    }\n}\n// Update streak\nasync function updateStreak(userId) {\n    const userProgressRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.doc)(_firebase_config__WEBPACK_IMPORTED_MODULE_0__.db, 'userProgress', userId);\n    const progress = await getUserProgress(userId);\n    if (progress) {\n        const lastStudyDate = new Date(progress.lastStudyDate);\n        const today = new Date();\n        const diffDays = Math.floor((today.getTime() - lastStudyDate.getTime()) / (1000 * 60 * 60 * 24));\n        let currentStreak = progress.currentStreak;\n        if (diffDays === 1) {\n            // Consecutive day\n            currentStreak += 1;\n            const longestStreak = Math.max(currentStreak, progress.longestStreak);\n            await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.updateDoc)(userProgressRef, {\n                currentStreak,\n                longestStreak,\n                lastStudyDate: today\n            });\n        } else if (diffDays > 1) {\n            // Streak broken\n            await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.updateDoc)(userProgressRef, {\n                currentStreak: 1,\n                lastStudyDate: today\n            });\n        }\n        // Check for streak achievements\n        if (currentStreak === 7) {\n            await addAchievement(userId, {\n                id: 'week-streak',\n                title: 'Week Warrior',\n                description: 'Studied for 7 days in a row!',\n                unlockedAt: new Date(),\n                icon: '🔥'\n            });\n        }\n    }\n}\n// Add achievement\nasync function addAchievement(userId, achievement) {\n    const userProgressRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.doc)(_firebase_config__WEBPACK_IMPORTED_MODULE_0__.db, 'userProgress', userId);\n    const progress = await getUserProgress(userId);\n    if (progress) {\n        const hasAchievement = progress.recentActivity.some((activity)=>activity.topic === achievement.title);\n        if (!hasAchievement) {\n            const activity = {\n                id: Date.now().toString(),\n                type: 'study',\n                subject: 'achievements',\n                topic: achievement.title,\n                timestamp: new Date()\n            };\n            await addActivity(userId, activity);\n        }\n    }\n}\n// Add activity\nasync function addActivity(userId, activity) {\n    const userProgressRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.doc)(_firebase_config__WEBPACK_IMPORTED_MODULE_0__.db, 'userProgress', userId);\n    const progress = await getUserProgress(userId);\n    if (progress) {\n        // Ensure timestamp is stored as a Firestore timestamp\n        const activityWithTimestamp = {\n            ...activity,\n            timestamp: activity.timestamp instanceof Date ? activity.timestamp.toISOString() : new Date().toISOString()\n        };\n        // Ensure recentActivity exists and is an array\n        const currentActivities = Array.isArray(progress.recentActivity) ? progress.recentActivity : [];\n        const updatedActivities = [\n            activityWithTimestamp,\n            ...currentActivities\n        ].slice(0, 10); // Keep only last 10 activities\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.updateDoc)(userProgressRef, {\n            recentActivity: updatedActivities\n        });\n    }\n}\n// Record quiz completion\nasync function recordQuizCompletion(userId, subject, score) {\n    const activity = {\n        id: Date.now().toString(),\n        type: 'study',\n        subject,\n        topic: 'quiz',\n        timestamp: new Date(),\n        score\n    };\n    await addActivity(userId, activity);\n    // Check for achievements\n    if (score >= 90) {\n        await addAchievement(userId, {\n            id: 'high-scorer',\n            title: 'High Scorer',\n            description: 'Scored 90% or higher on a quiz!',\n            unlockedAt: new Date(),\n            icon: '🎯'\n        });\n    }\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL2FwcC91dGlscy91c2VyUHJvZ3Jlc3MudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBd0M7QUFDNkM7QUFXckYsbURBQW1EO0FBQzVDLGVBQWVLLHVCQUF1QkMsTUFBYztJQUN6RCxNQUFNQyxrQkFBa0JOLHVEQUFHQSxDQUFDRCxnREFBRUEsRUFBRSxnQkFBZ0JNO0lBRWhELE1BQU1FLGtCQUFnQztRQUNwQ0Y7UUFDQUcsVUFBVSxDQUFDO1FBQ1hDLGdCQUFnQjtRQUNoQkMsZUFBZTtRQUNmQyxlQUFlO1FBQ2ZDLGVBQWUsSUFBSUM7UUFDbkJDLGdCQUFnQixFQUFFLENBQUMsNEJBQTRCO0lBQ2pEO0lBRUEsTUFBTVosMERBQU1BLENBQUNJLGlCQUFpQkM7SUFDOUIsT0FBT0E7QUFDVDtBQUVBLG9CQUFvQjtBQUNiLGVBQWVRLGdCQUFnQlYsTUFBYztJQUNsRCxNQUFNQyxrQkFBa0JOLHVEQUFHQSxDQUFDRCxnREFBRUEsRUFBRSxnQkFBZ0JNO0lBQ2hELE1BQU1XLFVBQVUsTUFBTWYsMERBQU1BLENBQUNLO0lBRTdCLElBQUlVLFFBQVFDLE1BQU0sSUFBSTtRQUNwQixNQUFNQyxPQUFPRixRQUFRRSxJQUFJO1FBQ3pCLGlEQUFpRDtRQUNqRCxJQUFJQSxLQUFLSixjQUFjLElBQUlLLE1BQU1DLE9BQU8sQ0FBQ0YsS0FBS0osY0FBYyxHQUFHO1lBQzdESSxLQUFLSixjQUFjLEdBQUdJLEtBQUtKLGNBQWMsQ0FBQ08sR0FBRyxDQUFDLENBQUNDO2dCQUM3QyxJQUFJLENBQUNBLFlBQVksT0FBT0EsYUFBYSxVQUFVO29CQUM3QyxPQUFPO3dCQUNMQyxJQUFJVixLQUFLVyxHQUFHLEdBQUdDLFFBQVE7d0JBQ3ZCQyxNQUFNO3dCQUNOQyxTQUFTO3dCQUNUQyxPQUFPO3dCQUNQQyxXQUFXLElBQUloQjtvQkFDakI7Z0JBQ0Y7Z0JBRUEsSUFBSTtvQkFDRixNQUFNZ0IsWUFBWVAsU0FBU08sU0FBUyxHQUNoQyxJQUFJ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LDZEQUFTQSxDQUFDRyxpQkFBaUI7WUFDL0JRLGdCQUFnQm1FO1FBQ2xCO0lBQ0Y7QUFDRjtBQUVBLHlCQUF5QjtBQUNsQixlQUFlRSxxQkFBcUI5RSxNQUFjLEVBQUVzQixPQUFlLEVBQUV5RCxLQUFhO0lBQ3ZGLE1BQU05RCxXQUEwQjtRQUM5QkMsSUFBSVYsS0FBS1csR0FBRyxHQUFHQyxRQUFRO1FBQ3ZCQyxNQUFNO1FBQ05DO1FBQ0FDLE9BQU87UUFDUEMsV0FBVyxJQUFJaEI7UUFDZnVFO0lBQ0Y7SUFFQSxNQUFNbEMsWUFBWTdDLFFBQVFpQjtJQUUxQix5QkFBeUI7SUFDekIsSUFBSThELFNBQVMsSUFBSTtRQUNmLE1BQU1kLGVBQWVqRSxRQUFRO1lBQzNCa0IsSUFBSTtZQUNKZ0QsT0FBTztZQUNQQyxhQUFhO1lBQ2JDLFlBQVksSUFBSTVEO1lBQ2hCNkQsTUFBTTtRQUNSO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxMb25kaVxcRGVza3RvcFxccHJvamVjdHNcXG1hdHJpY2tvbm5la3RcXGFwcFxcdXRpbHNcXHVzZXJQcm9ncmVzcy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBkYiB9IGZyb20gJy4uL2ZpcmViYXNlL2NvbmZpZyc7XHJcbmltcG9ydCB7IGRvYywgZ2V0RG9jLCBzZXREb2MsIHVwZGF0ZURvYywgc2VydmVyVGltZXN0YW1wIH0gZnJvbSAnZmlyZWJhc2UvZmlyZXN0b3JlJztcclxuaW1wb3J0IHsgVXNlclByb2dyZXNzLCBBY3Rpdml0eSwgU3R1ZHlBY3Rpdml0eSB9IGZyb20gJy4uL3R5cGVzL3VzZXInO1xyXG5cclxuaW50ZXJmYWNlIEFjaGlldmVtZW50IHtcclxuICBpZDogc3RyaW5nO1xyXG4gIHRpdGxlOiBzdHJpbmc7XHJcbiAgZGVzY3JpcHRpb246IHN0cmluZztcclxuICB1bmxvY2tlZEF0OiBEYXRlO1xyXG4gIGljb246IHN0cmluZztcclxufVxyXG5cclxuLy8gSW5pdGlhbGl6ZSB1c2VyIHByb2dyZXNzIHdoZW4gdGhleSBmaXJzdCBzaWduIHVwXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbml0aWFsaXplVXNlclByb2dyZXNzKHVzZXJJZDogc3RyaW5nKSB7XHJcbiAgY29uc3QgdXNlclByb2dyZXNzUmVmID0gZG9jKGRiLCAndXNlclByb2dyZXNzJywgdXNlcklkKTtcclxuICBcclxuICBjb25zdCBpbml0aWFsUHJvZ3Jlc3M6IFVzZXJQcm9ncmVzcyA9IHtcclxuICAgIHVzZXJJZCxcclxuICAgIHN1YmplY3RzOiB7fSxcclxuICAgIHRvdGFsU3R1ZHlUaW1lOiAwLFxyXG4gICAgY3VycmVudFN0cmVhazogMCxcclxuICAgIGxvbmdlc3RTdHJlYWs6IDAsXHJcbiAgICBsYXN0U3R1ZHlEYXRlOiBuZXcgRGF0ZSgpLFxyXG4gICAgcmVjZW50QWN0aXZpdHk6IFtdIC8vIEluaXRpYWxpemUgYXMgZW1wdHkgYXJyYXlcclxuICB9O1xyXG5cclxuICBhd2FpdCBzZXREb2ModXNlclByb2dyZXNzUmVmLCBpbml0aWFsUHJvZ3Jlc3MpO1xyXG4gIHJldHVybiBpbml0aWFsUHJvZ3Jlc3M7XHJcbn1cclxuXHJcbi8vIEdldCB1c2VyIHByb2dyZXNzXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRVc2VyUHJvZ3Jlc3ModXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPFVzZXJQcm9ncmVzcyB8IG51bGw+IHtcclxuICBjb25zdCB1c2VyUHJvZ3Jlc3NSZWYgPSBkb2MoZGIsICd1c2VyUHJvZ3Jlc3MnLCB1c2VySWQpO1xyXG4gIGNvbnN0IGRvY1NuYXAgPSBhd2FpdCBnZXREb2ModXNlclByb2dyZXNzUmVmKTtcclxuICBcclxuICBpZiAoZG9jU25hcC5leGlzdHMoKSkge1xyXG4gICAgY29uc3QgZGF0YSA9IGRvY1NuYXAuZGF0YSgpO1xyXG4gICAgLy8gQ29udmVydCB0aW1lc3RhbXAgc3RyaW5ncyBiYWNrIHRvIERhdGUgb2JqZWN0c1xyXG4gICAgaWYgKGRhdGEucmVjZW50QWN0aXZpdHkgJiYgQXJyYXkuaXNBcnJheShkYXRhLnJlY2VudEFjdGl2aXR5KSkge1xyXG4gICAgICBkYXRhLnJlY2VudEFjdGl2aXR5ID0gZGF0YS5yZWNlbnRBY3Rpdml0eS5tYXAoKGFjdGl2aXR5OiBhbnkpID0+IHtcclxuICAgICAgICBpZiAoIWFjdGl2aXR5IHx8IHR5cGVvZiBhY3Rpdml0eSAhPT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGlkOiBEYXRlLm5vdygpLnRvU3RyaW5nKCksXHJcbiAgICAgICAgICAgIHR5cGU6ICdzdHVkeScsXHJcbiAgICAgICAgICAgIHN1YmplY3Q6ICd1bmtub3duJyxcclxuICAgICAgICAgICAgdG9waWM6ICd1bmtub3duJyxcclxuICAgICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpXHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIGNvbnN0IHRpbWVzdGFtcCA9IGFjdGl2aXR5LnRpbWVzdGFtcCBcclxuICAgICAgICAgICAgPyBuZXcgRGF0ZShhY3Rpdml0eS50aW1lc3RhbXApXHJcbiAgICAgICAgICAgIDogbmV3IERhdGUoKTtcclxuXHJcbiAgICAgICAgICBpZiAoaXNOYU4odGltZXN0YW1wLmdldFRpbWUoKSkpIHtcclxuICAgICAgICAgICAgY29uc29sZS53YXJuKCdJbnZhbGlkIHRpbWVzdGFtcCBpbiBhY3Rpdml0eTonLCBhY3Rpdml0eSk7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgLi4uYWN0aXZpdHksXHJcbiAgICAgICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgLi4uYWN0aXZpdHksXHJcbiAgICAgICAgICAgIHRpbWVzdGFtcFxyXG4gICAgICAgICAgfTtcclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgY29uc29sZS53YXJuKCdFcnJvciBjb252ZXJ0aW5nIHRpbWVzdGFtcDonLCBlcnJvcik7XHJcbiAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAuLi5hY3Rpdml0eSxcclxuICAgICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpXHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyBJbml0aWFsaXplIHJlY2VudEFjdGl2aXR5IGlmIGl0IGRvZXNuJ3QgZXhpc3RcclxuICAgICAgZGF0YS5yZWNlbnRBY3Rpdml0eSA9IFtdO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGRhdGEgYXMgVXNlclByb2dyZXNzO1xyXG4gIH1cclxuICByZXR1cm4gbnVsbDtcclxufVxyXG5cclxuLy8gTWFyayBsZXNzb24gYXMgY29tcGxldGVkXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBtYXJrTGVzc29uQ29tcGxldGVkKFxyXG4gIHVzZXJJZDogc3RyaW5nLFxyXG4gIHN1YmplY3RJZDogc3RyaW5nLFxyXG4gIHRvcGljSWQ6IHN0cmluZyxcclxuICBsZXNzb25JZDogbnVtYmVyXHJcbikge1xyXG4gIGNvbnN0IHVzZXJQcm9ncmVzc1JlZiA9IGRvYyhkYiwgJ3VzZXJQcm9ncmVzcycsIHVzZXJJZCk7XHJcbiAgY29uc3QgcHJvZ3Jlc3MgPSBhd2FpdCBnZXRVc2VyUHJvZ3Jlc3ModXNlcklkKTtcclxuXHJcbiAgaWYgKHByb2dyZXNzKSB7XHJcbiAgICAvLyBJbml0aWFsaXplIHN1YmplY3RzIGlmIGl0IGRvZXNuJ3QgZXhpc3RcclxuICAgIGNvbnN0IHN1YmplY3RzID0gcHJvZ3Jlc3Muc3ViamVjdHMgfHwge307XHJcbiAgICBcclxuICAgIGNvbnN0IHN1YmplY3QgPSBzdWJqZWN0c1tzdWJqZWN0SWRdIHx8IHtcclxuICAgICAgcHJvZ3Jlc3M6IDAsXHJcbiAgICAgIGNvbXBsZXRlZFRvcGljczogW10sXHJcbiAgICAgIGNvbXBsZXRlZExlc3NvbnM6IHt9LFxyXG4gICAgICBsYXN0U3R1ZGllZDogbmV3IERhdGUoKVxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBVcGRhdGUgY29tcGxldGVkIGxlc3NvbnNcclxuICAgIGNvbnN0IHRvcGljTGVzc29ucyA9IHN1YmplY3QuY29tcGxldGVkTGVzc29uc1t0b3BpY0lkXSB8fCBbXTtcclxuICAgIGlmICghdG9waWNMZXNzb25zLmluY2x1ZGVzKGxlc3NvbklkKSkge1xyXG4gICAgICB0b3BpY0xlc3NvbnMucHVzaChsZXNzb25JZCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ2FsY3VsYXRlIHRvcGljIHByb2dyZXNzXHJcbiAgICBjb25zdCB0b3BpY1Byb2dyZXNzID0gY2FsY3VsYXRlVG9waWNQcm9ncmVzcyh0b3BpY0xlc3NvbnMpO1xyXG4gICAgXHJcbiAgICAvLyBVcGRhdGUgc3ViamVjdCBwcm9ncmVzc1xyXG4gICAgY29uc3QgdXBkYXRlZFN1YmplY3RzID0ge1xyXG4gICAgICAuLi5zdWJqZWN0cyxcclxuICAgICAgW3N1YmplY3RJZF06IHtcclxuICAgICAgICAuLi5zdWJqZWN0LFxyXG4gICAgICAgIGNvbXBsZXRlZExlc3NvbnM6IHtcclxuICAgICAgICAgIC4uLnN1YmplY3QuY29tcGxldGVkTGVzc29ucyxcclxuICAgICAgICAgIFt0b3BpY0lkXTogdG9waWNMZXNzb25zXHJcbiAgICAgICAgfSxcclxuICAgICAgICBwcm9ncmVzczogY2FsY3VsYXRlU3ViamVjdFByb2dyZXNzKHN1YmplY3QsIHRvcGljSWQsIHRvcGljUHJvZ3Jlc3MpLFxyXG4gICAgICAgIGxhc3RTdHVkaWVkOiBuZXcgRGF0ZSgpXHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgYXdhaXQgdXBkYXRlRG9jKHVzZXJQcm9ncmVzc1JlZiwgeyBzdWJqZWN0czogdXBkYXRlZFN1YmplY3RzIH0pO1xyXG5cclxuICAgIC8vIEFkZCBhY3Rpdml0eVxyXG4gICAgY29uc3QgYWN0aXZpdHk6IFN0dWR5QWN0aXZpdHkgPSB7XHJcbiAgICAgIGlkOiBEYXRlLm5vdygpLnRvU3RyaW5nKCksXHJcbiAgICAgIHR5cGU6ICdzdHVkeScsXHJcbiAgICAgIHN1YmplY3Q6IHN1YmplY3RJZCxcclxuICAgICAgdG9waWM6IHRvcGljSWQsXHJcbiAgICAgIGxlc3NvbklkLFxyXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcclxuICAgIH07XHJcblxyXG4gICAgYXdhaXQgYWRkQWN0aXZpdHkodXNlcklkLCBhY3Rpdml0eSk7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBDYWxjdWxhdGUgdG9waWMgcHJvZ3Jlc3MgYmFzZWQgb24gY29tcGxldGVkIGxlc3NvbnNcclxuZnVuY3Rpb24gY2FsY3VsYXRlVG9waWNQcm9ncmVzcyhjb21wbGV0ZWRMZXNzb25zOiBudW1iZXJbXSk6IG51bWJlciB7XHJcbiAgLy8gQXNzdW1pbmcgZWFjaCB0b3BpYyBoYXMgYSBmaXhlZCBudW1iZXIgb2YgbGVzc29ucyAoZS5nLiwgNSlcclxuICBjb25zdCB0b3RhbExlc3NvbnMgPSA1OyAvLyBUaGlzIHNob3VsZCBiZSBkeW5hbWljIGJhc2VkIG9uIGFjdHVhbCBsZXNzb24gY291bnRcclxuICByZXR1cm4gKGNvbXBsZXRlZExlc3NvbnMubGVuZ3RoIC8gdG90YWxMZXNzb25zKSAqIDEwMDtcclxufVxyXG5cclxuLy8gQ2FsY3VsYXRlIHN1YmplY3QgcHJvZ3Jlc3MgYmFzZWQgb24gdG9waWMgcHJvZ3Jlc3NcclxuZnVuY3Rpb24gY2FsY3VsYXRlU3ViamVjdFByb2dyZXNzKFxyXG4gIHN1YmplY3Q6IGFueSxcclxuICB1cGRhdGVkVG9waWNJZDogc3RyaW5nLFxyXG4gIHVwZGF0ZWRUb3BpY1Byb2dyZXNzOiBudW1iZXJcclxuKTogbnVtYmVyIHtcclxuICBjb25zdCB0b3BpY3MgPSBPYmplY3Qua2V5cyhzdWJqZWN0LmNvbXBsZXRlZExlc3NvbnMpO1xyXG4gIGNvbnN0IHRvdGFsVG9waWNzID0gdG9waWNzLmxlbmd0aDtcclxuICBcclxuICBpZiAodG90YWxUb3BpY3MgPT09IDApIHJldHVybiAwO1xyXG4gIFxyXG4gIGxldCB0b3RhbFByb2dyZXNzID0gMDtcclxuICB0b3BpY3MuZm9yRWFjaCh0b3BpY0lkID0+IHtcclxuICAgIGNvbnN0IHRvcGljTGVzc29ucyA9IHN1YmplY3QuY29tcGxldGVkTGVzc29uc1t0b3BpY0lkXSB8fCBbXTtcclxuICAgIGNvbnN0IHRvcGljUHJvZ3Jlc3MgPSBjYWxjdWxhdGVUb3BpY1Byb2dyZXNzKHRvcGljTGVzc29ucyk7XHJcbiAgICB0b3RhbFByb2dyZXNzICs9IHRvcGljUHJvZ3Jlc3M7XHJcbiAgfSk7XHJcbiAgXHJcbiAgcmV0dXJuIHRvdGFsUHJvZ3Jlc3MgLyB0b3RhbFRvcGljcztcclxufVxyXG5cclxuLy8gVXBkYXRlIHN0dWR5IHRpbWVcclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVN0dWR5VGltZSh1c2VySWQ6IHN0cmluZywgbWludXRlc1N0dWRpZWQ6IG51bWJlcikge1xyXG4gIGNvbnN0IHVzZXJQcm9ncmVzc1JlZiA9IGRvYyhkYiwgJ3VzZXJQcm9ncmVzcycsIHVzZXJJZCk7XHJcbiAgY29uc3QgcHJvZ3Jlc3MgPSBhd2FpdCBnZXRVc2VyUHJvZ3Jlc3ModXNlcklkKTtcclxuXHJcbiAgaWYgKHByb2dyZXNzKSB7XHJcbiAgICBjb25zdCB0b3RhbFN0dWR5VGltZSA9IHByb2dyZXNzLnRvdGFsU3R1ZHlUaW1lICsgbWludXRlc1N0dWRpZWQ7XHJcbiAgICBhd2FpdCB1cGRhdGVEb2ModXNlclByb2dyZXNzUmVmLCB7IHRvdGFsU3R1ZHlUaW1lIH0pO1xyXG4gIH1cclxufVxyXG5cclxuLy8gTWFyayB0b3BpYyBhcyBjb21wbGV0ZWRcclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG1hcmtUb3BpY0NvbXBsZXRlZCh1c2VySWQ6IHN0cmluZywgc3ViamVjdElkOiBzdHJpbmcsIHRvcGljSWQ6IHN0cmluZykge1xyXG4gIGNvbnN0IHVzZXJQcm9ncmVzc1JlZiA9IGRvYyhkYiwgJ3VzZXJQcm9ncmVzcycsIHVzZXJJZCk7XHJcbiAgY29uc3QgcHJvZ3Jlc3MgPSBhd2FpdCBnZXRVc2VyUHJvZ3Jlc3ModXNlcklkKTtcclxuXHJcbiAgaWYgKHByb2dyZXNzKSB7XHJcbiAgICBjb25zdCBzdWJqZWN0ID0gcHJvZ3Jlc3Muc3ViamVjdHNbc3ViamVjdElkXSB8fCB7XHJcbiAgICAgIHByb2dyZXNzOiAwLFxyXG4gICAgICBjb21wbGV0ZWRUb3BpY3M6IFtdLFxyXG4gICAgICBsYXN0U3R1ZGllZDogbmV3IERhdGUoKVxyXG4gICAgfTtcclxuXHJcbiAgICBpZiAoIXN1YmplY3QuY29tcGxldGVkVG9waWNzLmluY2x1ZGVzKHRvcGljSWQpKSB7XHJcbiAgICAgIGNvbnN0IHVwZGF0ZWRTdWJqZWN0cyA9IHtcclxuICAgICAgICAuLi5wcm9ncmVzcy5zdWJqZWN0cyxcclxuICAgICAgICBbc3ViamVjdElkXToge1xyXG4gICAgICAgICAgLi4uc3ViamVjdCxcclxuICAgICAgICAgIGNvbXBsZXRlZFRvcGljczogWy4uLnN1YmplY3QuY29tcGxldGVkVG9waWNzLCB0b3BpY0lkXSxcclxuICAgICAgICAgIGxhc3RTdHVkaWVkOiBuZXcgRGF0ZSgpXHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgYXdhaXQgdXBkYXRlRG9jKHVzZXJQcm9ncmVzc1JlZiwgeyBzdWJqZWN0czogdXBkYXRlZFN1YmplY3RzIH0pO1xyXG5cclxuICAgICAgLy8gQWRkIGFjdGl2aXR5XHJcbiAgICAgIGNvbnN0IGFjdGl2aXR5OiBTdHVkeUFjdGl2aXR5ID0ge1xyXG4gICAgICAgIGlkOiBEYXRlLm5vdygpLnRvU3RyaW5nKCksXHJcbiAgICAgICAgdHlwZTogJ3N0dWR5JyxcclxuICAgICAgICBzdWJqZWN0OiBzdWJqZWN0SWQsXHJcbiAgICAgICAgdG9waWM6IHRvcGljSWQsXHJcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpXHJcbiAgICAgIH07XHJcblxyXG4gICAgICBhd2FpdCBhZGRBY3Rpdml0eSh1c2VySWQsIGFjdGl2aXR5KTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbi8vIFVwZGF0ZSBzdHJlYWtcclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVN0cmVhayh1c2VySWQ6IHN0cmluZykge1xyXG4gIGNvbnN0IHVzZXJQcm9ncmVzc1JlZiA9IGRvYyhkYiwgJ3VzZXJQcm9ncmVzcycsIHVzZXJJZCk7XHJcbiAgY29uc3QgcHJvZ3Jlc3MgPSBhd2FpdCBnZXRVc2VyUHJvZ3Jlc3ModXNlcklkKTtcclxuXHJcbiAgaWYgKHByb2dyZXNzKSB7XHJcbiAgICBjb25zdCBsYXN0U3R1ZHlEYXRlID0gbmV3IERhdGUocHJvZ3Jlc3MubGFzdFN0dWR5RGF0ZSk7XHJcbiAgICBjb25zdCB0b2RheSA9IG5ldyBEYXRlKCk7XHJcbiAgICBjb25zdCBkaWZmRGF5cyA9IE1hdGguZmxvb3IoKHRvZGF5LmdldFRpbWUoKSAtIGxhc3RTdHVkeURhdGUuZ2V0VGltZSgpKSAvICgxMDAwICogNjAgKiA2MCAqIDI0KSk7XHJcblxyXG4gICAgbGV0IGN1cnJlbnRTdHJlYWsgPSBwcm9ncmVzcy5jdXJyZW50U3RyZWFrO1xyXG4gICAgaWYgKGRpZmZEYXlzID09PSAxKSB7XHJcbiAgICAgIC8vIENvbnNlY3V0aXZlIGRheVxyXG4gICAgICBjdXJyZW50U3RyZWFrICs9IDE7XHJcbiAgICAgIGNvbnN0IGxvbmdlc3RTdHJlYWsgPSBNYXRoLm1heChjdXJyZW50U3RyZWFrLCBwcm9ncmVzcy5sb25nZXN0U3RyZWFrKTtcclxuICAgICAgYXdhaXQgdXBkYXRlRG9jKHVzZXJQcm9ncmVzc1JlZiwge1xyXG4gICAgICAgIGN1cnJlbnRTdHJlYWssXHJcbiAgICAgICAgbG9uZ2VzdFN0cmVhayxcclxuICAgICAgICBsYXN0U3R1ZHlEYXRlOiB0b2RheVxyXG4gICAgICB9KTtcclxuICAgIH0gZWxzZSBpZiAoZGlmZkRheXMgPiAxKSB7XHJcbiAgICAgIC8vIFN0cmVhayBicm9rZW5cclxuICAgICAgYXdhaXQgdXBkYXRlRG9jKHVzZXJQcm9ncmVzc1JlZiwge1xyXG4gICAgICAgIGN1cnJlbnRTdHJlYWs6IDEsXHJcbiAgICAgICAgbGFzdFN0dWR5RGF0ZTogdG9kYXlcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ2hlY2sgZm9yIHN0cmVhayBhY2hpZXZlbWVudHNcclxuICAgIGlmIChjdXJyZW50U3RyZWFrID09PSA3KSB7XHJcbiAgICAgIGF3YWl0IGFkZEFjaGlldmVtZW50KHVzZXJJZCwge1xyXG4gICAgICAgIGlkOiAnd2Vlay1zdHJlYWsnLFxyXG4gICAgICAgIHRpdGxlOiAnV2VlayBXYXJyaW9yJyxcclxuICAgICAgICBkZXNjcmlwdGlvbjogJ1N0dWRpZWQgZm9yIDcgZGF5cyBpbiBhIHJvdyEnLFxyXG4gICAgICAgIHVubG9ja2VkQXQ6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgaWNvbjogJ/CflKUnXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuLy8gQWRkIGFjaGlldmVtZW50XHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhZGRBY2hpZXZlbWVudCh1c2VySWQ6IHN0cmluZywgYWNoaWV2ZW1lbnQ6IEFjaGlldmVtZW50KSB7XHJcbiAgY29uc3QgdXNlclByb2dyZXNzUmVmID0gZG9jKGRiLCAndXNlclByb2dyZXNzJywgdXNlcklkKTtcclxuICBjb25zdCBwcm9ncmVzcyA9IGF3YWl0IGdldFVzZXJQcm9ncmVzcyh1c2VySWQpO1xyXG5cclxuICBpZiAocHJvZ3Jlc3MpIHtcclxuICAgIGNvbnN0IGhhc0FjaGlldmVtZW50ID0gcHJvZ3Jlc3MucmVjZW50QWN0aXZpdHkuc29tZShcclxuICAgICAgYWN0aXZpdHkgPT4gYWN0aXZpdHkudG9waWMgPT09IGFjaGlldmVtZW50LnRpdGxlXHJcbiAgICApO1xyXG4gICAgXHJcbiAgICBpZiAoIWhhc0FjaGlldmVtZW50KSB7XHJcbiAgICAgIGNvbnN0IGFjdGl2aXR5OiBTdHVkeUFjdGl2aXR5ID0ge1xyXG4gICAgICAgIGlkOiBEYXRlLm5vdygpLnRvU3RyaW5nKCksXHJcbiAgICAgICAgdHlwZTogJ3N0dWR5JyxcclxuICAgICAgICBzdWJqZWN0OiAnYWNoaWV2ZW1lbnRzJyxcclxuICAgICAgICB0b3BpYzogYWNoaWV2ZW1lbnQudGl0bGUsXHJcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpXHJcbiAgICAgIH07XHJcblxyXG4gICAgICBhd2FpdCBhZGRBY3Rpdml0eSh1c2VySWQsIGFjdGl2aXR5KTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbi8vIEFkZCBhY3Rpdml0eVxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYWRkQWN0aXZpdHkodXNlcklkOiBzdHJpbmcsIGFjdGl2aXR5OiBTdHVkeUFjdGl2aXR5KSB7XHJcbiAgY29uc3QgdXNlclByb2dyZXNzUmVmID0gZG9jKGRiLCAndXNlclByb2dyZXNzJywgdXNlcklkKTtcclxuICBjb25zdCBwcm9ncmVzcyA9IGF3YWl0IGdldFVzZXJQcm9ncmVzcyh1c2VySWQpO1xyXG5cclxuICBpZiAocHJvZ3Jlc3MpIHtcclxuICAgIC8vIEVuc3VyZSB0aW1lc3RhbXAgaXMgc3RvcmVkIGFzIGEgRmlyZXN0b3JlIHRpbWVzdGFtcFxyXG4gICAgY29uc3QgYWN0aXZpdHlXaXRoVGltZXN0YW1wID0ge1xyXG4gICAgICAuLi5hY3Rpdml0eSxcclxuICAgICAgdGltZXN0YW1wOiBhY3Rpdml0eS50aW1lc3RhbXAgaW5zdGFuY2VvZiBEYXRlIFxyXG4gICAgICAgID8gYWN0aXZpdHkudGltZXN0YW1wLnRvSVNPU3RyaW5nKClcclxuICAgICAgICA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBFbnN1cmUgcmVjZW50QWN0aXZpdHkgZXhpc3RzIGFuZCBpcyBhbiBhcnJheVxyXG4gICAgY29uc3QgY3VycmVudEFjdGl2aXRpZXMgPSBBcnJheS5pc0FycmF5KHByb2dyZXNzLnJlY2VudEFjdGl2aXR5KSBcclxuICAgICAgPyBwcm9ncmVzcy5yZWNlbnRBY3Rpdml0eSBcclxuICAgICAgOiBbXTtcclxuXHJcbiAgICBjb25zdCB1cGRhdGVkQWN0aXZpdGllcyA9IFthY3Rpdml0eVdpdGhUaW1lc3RhbXAsIC4uLmN1cnJlbnRBY3Rpdml0aWVzXS5zbGljZSgwLCAxMCk7IC8vIEtlZXAgb25seSBsYXN0IDEwIGFjdGl2aXRpZXNcclxuICAgIFxyXG4gICAgYXdhaXQgdXBkYXRlRG9jKHVzZXJQcm9ncmVzc1JlZiwge1xyXG4gICAgICByZWNlbnRBY3Rpdml0eTogdXBkYXRlZEFjdGl2aXRpZXNcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuLy8gUmVjb3JkIHF1aXogY29tcGxldGlvblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVjb3JkUXVpekNvbXBsZXRpb24odXNlcklkOiBzdHJpbmcsIHN1YmplY3Q6IHN0cmluZywgc2NvcmU6IG51bWJlcikge1xyXG4gIGNvbnN0IGFjdGl2aXR5OiBTdHVkeUFjdGl2aXR5ID0ge1xyXG4gICAgaWQ6IERhdGUubm93KCkudG9TdHJpbmcoKSxcclxuICAgIHR5cGU6ICdzdHVkeScsXHJcbiAgICBzdWJqZWN0LFxyXG4gICAgdG9waWM6ICdxdWl6JyxcclxuICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcclxuICAgIHNjb3JlXHJcbiAgfTtcclxuXHJcbiAgYXdhaXQgYWRkQWN0aXZpdHkodXNlcklkLCBhY3Rpdml0eSk7XHJcblxyXG4gIC8vIENoZWNrIGZvciBhY2hpZXZlbWVudHNcclxuICBpZiAoc2NvcmUgPj0gOTApIHtcclxuICAgIGF3YWl0IGFkZEFjaGlldmVtZW50KHVzZXJJZCwge1xyXG4gICAgICBpZDogJ2hpZ2gtc2NvcmVyJyxcclxuICAgICAgdGl0bGU6ICdIaWdoIFNjb3JlcicsXHJcbiAgICAgIGRlc2NyaXB0aW9uOiAnU2NvcmVkIDkwJSBvciBoaWdoZXIgb24gYSBxdWl6IScsXHJcbiAgICAgIHVubG9ja2VkQXQ6IG5ldyBEYXRlKCksXHJcbiAgICAgIGljb246ICfwn46vJ1xyXG4gICAgfSk7XHJcbiAgfVxyXG59ICJdLCJuYW1lcyI6WyJkYiIsImRvYyIsImdldERvYyIsInNldERvYyIsInVwZGF0ZURvYyIsImluaXRpYWxpemVVc2VyUHJvZ3Jlc3MiLCJ1c2VySWQiLCJ1c2VyUHJvZ3Jlc3NSZWYiLCJpbml0aWFsUHJvZ3Jlc3MiLCJzdWJqZWN0cyIsInRvdGFsU3R1ZHlUaW1lIiwiY3VycmVudFN0cmVhayIsImxvbmdlc3RTdHJlYWsiLCJsYXN0U3R1ZHlEYXRlIiwiRGF0ZSIsInJlY2VudEFjdGl2aXR5IiwiZ2V0VXNlclByb2dyZXNzIiwiZG9jU25hcCIsImV4aXN0cyIsImRhdGEiLCJBcnJheSIsImlzQXJyYXkiLCJtYXAiLCJhY3Rpdml0eSIsImlkIiwibm93IiwidG9TdHJpbmciLCJ0eXBlIiwic3ViamVjdCIsInRvcGljIiwidGltZXN0YW1wIiwiaXNOYU4iLCJnZXRUaW1lIiwiY29uc29sZSIsIndhcm4iLCJlcnJvciIsIm1hcmtMZXNzb25Db21wbGV0ZWQiLCJzdWJqZWN0SWQiLCJ0b3BpY0lkIiwibGVzc29uSWQiLCJwcm9ncmVzcyIsImNvbXBsZXRlZFRvcGljcyIsImNvbXBsZXRlZExlc3NvbnMiLCJsYXN0U3R1ZGllZCIsInRvcGljTGVzc29ucyIsImluY2x1ZGVzIiwicHVzaCIsInRvcGljUHJvZ3Jlc3MiLCJjYWxjdWxhdGVUb3BpY1Byb2dyZXNzIiwidXBkYXRlZFN1YmplY3RzIiwiY2FsY3VsYXRlU3ViamVjdFByb2dyZXNzIiwiYWRkQWN0aXZpdHkiLCJ0b3RhbExlc3NvbnMiLCJsZW5ndGgiLCJ1cGRhdGVkVG9waWNJZCIsInVwZGF0ZWRUb3BpY1Byb2dyZXNzIiwidG9waWNzIiwiT2JqZWN0Iiwia2V5cyIsInRvdGFsVG9waWNzIiwidG90YWxQcm9ncmVzcyIsImZvckVhY2giLCJ1cGRhdGVTdHVkeVRpbWUiLCJtaW51dGVzU3R1ZGllZCIsIm1hcmtUb3BpY0NvbXBsZXRlZCIsInVwZGF0ZVN0cmVhayIsInRvZGF5IiwiZGlmZkRheXMiLCJNYXRoIiwiZmxvb3IiLCJtYXgiLCJhZGRBY2hpZXZlbWVudCIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJ1bmxvY2tlZEF0IiwiaWNvbiIsImFjaGlldmVtZW50IiwiaGFzQWNoaWV2ZW1lbnQiLCJzb21lIiwiYWN0aXZpdHlXaXRoVGltZXN0YW1wIiwidG9JU09TdHJpbmciLCJjdXJyZW50QWN0aXZpdGllcyIsInVwZGF0ZWRBY3Rpdml0aWVzIiwic2xpY2UiLCJyZWNvcmRRdWl6Q29tcGxldGlvbiIsInNjb3JlIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./app/utils/userProgress.ts\n"));

/***/ })

});